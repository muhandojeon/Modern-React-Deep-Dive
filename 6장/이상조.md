# 리액트 개발 도구로 디버깅하기

## 리액트 개발 도구란

- 리액트로 만들어진 다양한 앱을 디버깅하기 위해 만들어짐.
- RN에서도 사용 가능
- 브라우저 확장 프로그램을 사용하는 것이 가장 편리함

## 리액트 개발 도구 활용하기

### 컴포넌트

- 현재 리액트 앱의 컴포넌트 트리를 확인할 수 있다.
- props와 내부에서 사용된 hooks등 다양한 정보를 확인할 수 있음

#### 컴포넌트 트리

- 컴포넌트 탭의 왼쪽 영역은 해당 페이지의 컴포넌트 트리를 나타냄
- 기명 함수로 선언되어 컴포넌트명을 알 수 있다면 컴포넌트명을 보여주고, 익명 함수라면 Anonymous로 보여준다.
- displayName을 사용하면 컴포넌트명에 displayName으로 작성한 문자열이 나온다.
  - forwardRef를 사용할때 displayName을 사용해야하는 이유가 forwardRef가 HOC이기 때문인듯

#### 컴포넌트명과 props

- 컴포넌트 트리에서 컴포넌트를 선택하면 오른쪽에 해당 컴포넌트에 대한 자세한 정보를 보여준다.
- 컴포넌트 도구
  - 눈 아이콘 : 누르면 element탭으로 이동하며 해당 html요소가 선택된다
  - 벌레 아이콘 : console탭에 해당 컴포넌트의 정보가 기록됨. props나 hooks등 다양한 정보가 포함되어 있다.
  - 소스코드 아이콘 : source탭에서 해당 컴포넌트의 소스코드를 확인할 수 있다. 다만 sourceMap이 없는 경우 빌드 결과물을 알아보기란 쉽지 않다.
- 컴포넌트 props
  - 원시값뿐만 아니라 함수 props까지 확인 가능.
  - 우클릭하여 클립보드에 복사하거나 window.temp 변수에 값을 할당하여 콘솔에서 찍어볼 수 있음.
  - 함수 props를 누르면 해당 함수가 정의된 곳으로 이동할 수 있는데, 마찬가지로 source탭에서 알아보기란 쉽지 않음
- 컴포넌트 hooks
  - 컴포넌트에서 사용중인 hooks가 use prefix 제거된 이름으로 보여짐
  - useEffect처럼 콜백을 받을 경우, 기명 함수를 사용하면 좀 더 편하게 디버깅할 수 있다.
- 컴포넌트 렌더링 주체, rendered by
  - 개발 모드에서는 해당 컴포넌트를 렌덜이한 부모 컴포넌트까지 확인 가능

### 프로파일러

- 리액트가 렌더링하는 과정에서 발생하는 상황을 확인하기 위한 도구.
- 어떤 컴포넌트가 렌더링됐는지, 몇 번의 리렌더링이 발생했는지, 어떤 장업에서 오래 걸렸는지 등
- 프로덕션 빌드로 실행되는 리액트 앱에서는 사용할 수 없다.

#### 설정

- debugging탭의 hide logs during second render in StrictMode를 활성화하면 StrictMode에서 useEffect안의 console.log가 두 번 실행되는 것을 방지할 수 있음.
- profiler탭의 record why each component rendered while profiling을 활성화하면 무엇때문에 컴포넌트가 렌더링됐는지를 기록한다.

#### 프로파일링

- 프로파일링 메뉴
  - Start Profiling 버튼 : 누르면 프로파일링이 시장된다.
  - Reload and Start profiling 버튼 : 누르면 웹페이지가 새로고침되면서 동시에 프로파일링이 시작된다.
  - Stop profiling 버튼 : 프로파일링된 현재 내용을 모두 지우는 버튼.
  - Load Profile, Save Profile 버튼 : 프로파일링 결과를 JSON으로 내보내고 불러올 수 있다. 그러나 직접 열어서 확인하기에는 매우 복잡하다.
- Flamegraph
  - 불꽃 모양 버튼
  - 렌더 커밋별로 어떤 작업이 일어났는지 나타낸다.
  - 너비가 넓을수록 해당 컴포넌트의 렌더링이 오래 걸렸다는 것을 의미함.
  - 노란색에 가까울수록 오래 걸리고, 초록색에 가까울수록 빠르게 렌더링된 컴포넌트. 회색은 렌더링되지 않은 컴포넌트
  - 렌더링이 발생한 횟수도 확인할 수 있다.
- Ranked
  - 해당 커밋에서 렌더링하는 데 오랜 시간이 걸린 컴포넌트를 순서대로 나열한 그래프
  - 렌더링이 발생한 컴포넌트만 보여준다.
- 타임라인
  - 리액트 18 이상의 환경에서만 확인할 수 있음.
  - 시간의 흐름에 따라 리액트가 작동하는 내용을 추적
  - 무엇이 렌더링됐고, 어느 시점에 렌더링됐고...

## 정리

- 앱을 다 완성하고 개발 도구를 열어보면 복잡해서 제대로 활용하기 어려울 수 있다.
- 개발하는 과정에서 최대한 활용해보자.
